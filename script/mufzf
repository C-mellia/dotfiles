#!/bin/bash

# A satisfactory and elegant script for those who really love reading books.

select=$(
find . -maxdepth 1 -not -path '*/.*' -type f -exec basename {} \;\
	| grep -E '.pdf$|.epub$'\
	| fzf -m --cycle\
	--bind ctrl-l:toggle\
	--bind ctrl-h:cancel
)

if [[ -z $select ]]; then
	exit 0
fi

if ! [[ -z $1 ]]; then
	i3-msg "workspace $1"

	if [[ $? -ne 0 ]]; then
		echo "Workspace $1 not found"
		exit 1
	fi
fi

while read -r file; do
	nohup mupdf "$file" 2&> /dev/null & disown
done <<< $select
